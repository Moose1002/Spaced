// room script file

function room_Load()
{
  //TintScreen(10, 10, 10);
  
  player.LockView(2, eStopMoving);
}

function oObject0_Look(Object *theObject, CursorMode mode)
{
  Display("I am not going back under there!");
}

function room_AfterFadeIn()
{
  
}

function room_FirstLoad()
{
  RemoveWalkableArea(1);
  //dOpening.Start();
}
function room_RepExec()
{
  if (!IndependentShadow) 
  {
    cShadow.x = cArin.x + 10;
    cShadow.y = cArin.y + 5;
  }
  
  if (OpeningStuck) {
    if (player.ScriptName == "cArin") {
      RemoveWalkableArea(1);
    }
    else
    {
      RestoreWalkableArea(1);
    }
  }
  
  /*
  float t = 0.0;
  while (t <= 1.0) {
    int redTint = TweenMaths.Lerp(0.0, 100.0, t);
    TintScreen(redTint, 100, 100);
    Wait(1);
    t = t + 0.01;
  }
  */
}

function oScrewdriver_PickUp(Object *theObject, CursorMode mode)
{
  
}

function oScrewdriver_Interact(Object *theObject, CursorMode mode)
{
  if (OpeningStuck) 
  {
    cArin.Say("I can't reach it!");
    return; 
  }
  AddInventoryHelper(theObject, iScrewdriver);
}

function oObject0_Interact(Object *theObject, CursorMode mode)
{
  if (!OpeningStuck) 
  { 
    cArin.Say("Who helped me out of there?");
    return; 
  }
  if (player.ScriptName == "cArin") 
  {
    player.Say("I'm stuck!");
    player.Say("I don't think I'll be able to push this off on my own.");
  }
  else {
    player.Walk(115, 180, eBlock);
    theObject.TweenY(2.5, theObject.Y + 20);
    OpeningStuck = false;
    RestoreWalkableArea(1);
    cArin.SetAsPlayer();
    cArin.Say("Hey, thanks.");
    cArin.UnlockView();
    Wait(20);
    cArin.Say("Who are you?");
    cShadow.Say("...");
    cArin.Say("What are you?");
    Wait(100);
    TintScreen(1, 1, 1);
    cShadow.on = 0;
    cArin.Say("Hello?");
    cArin.Say("Where did he go?");
    cArin.Say("Well there goes the lights.");
    cArin.Say("Maybe I can get the lights back on?");
  }
}
