// room script file

bool previousRoomEnvironmentLitCache;
int playerXCache;
int playerYcache;

function room_AfterFadeIn()
{
  gCircuitExit.Visible = true;
}

function oCapacitor_Look(Object *theObject, CursorMode mode)
{
  if (!DoorRepaired) 
  {
  player.Say("Looks to be blown.");
  player.Say("Probably what's keeping the door closed.");
  player.Say("I think I might have a spare in my pocket!");
  }
}

function room_Leave()
{
  gCircuitExit.Visible = false;
  player.UnlockView();
  EnvironmentLit = previousRoomEnvironmentLitCache;
}

function oCapacitor_UseInv(Object *theObject, CursorMode mode)
{
  if (player.ActiveInventory == iCapacitor)
  {
    player.Say("This should fix it!");
    theObject.Graphic = 14;
    player.LoseInventory(iCapacitor);
    DoorRepaired = true;
  }
}

function room_Load()
{
  previousRoomEnvironmentLitCache = EnvironmentLit;
  EnvironmentLit = true;
  player.LockView(3, eKeepMoving);
  playerXCache = player.x;
  playerYcache = player.y;
  player.Move(160, 245, eNoBlock, eAnywhere);
}
